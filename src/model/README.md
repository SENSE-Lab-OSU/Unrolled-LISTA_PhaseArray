Contains the main model training and inference code.